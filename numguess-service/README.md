# Number Guessing Game - Spring Boot Service

This is a Spring Boot REST API service for a number guessing game, generated from an OpenAPI specification.

## Overview

The service boilerplate was generated by the [OpenAPI Generator](https://openapi-generator.tech) from `openapi.yaml`. The implementation uses the delegate pattern to separate generated code from business logic:

- **Generated code** in `org.openapitools.*` packages (interfaces, models, controllers)
- **Custom implementation** in `edu.luc.cs.numguess.*` packages (delegates, domain model, services)

This separation allows the generated code to be safely regenerated without losing custom business logic.

## Architecture

### Generated vs. Custom Code

**Generated (read-only):**
- `org.openapitools.api.GamesApiDelegate` - Interface for /games endpoints
- `org.openapitools.api.GameApiDelegate` - Interface for /games/{uuid} endpoints
- `org.openapitools.model.*` - All API request/response model classes
- Controller classes that route HTTP requests to delegates

**Custom Implementation:**
- `edu.luc.cs.numguess.delegate.GamesApiDelegateImpl` - Implements collection operations
- `edu.luc.cs.numguess.delegate.GameApiDelegateImpl` - Implements individual game operations
- `edu.luc.cs.numguess.domain.Game` - Domain model with game logic
- `edu.luc.cs.numguess.service.GameService` - Service layer with business logic
- `edu.luc.cs.numguess.util.HateoasLinkBuilder` - Hypermedia link construction utility

### Key Features

- **Level 3 HATEOAS**: State-driven affordances where available actions (links) change based on resource state
- **Thread-Safe Operations**: ConcurrentHashMap for game storage, AtomicInteger for best score tracking
- **Comprehensive Error Handling**: Proper HTTP status codes and error messages
- **Environment-Aware URLs**: Links automatically adapt to deployment context (localhost, production, etc.)
- **Contract-First Design**: API behavior defined in OpenAPI spec, implementation follows the contract

## Building

```bash
# Build the project
./mvnw clean package
```

## Running

```bash
# Start the Spring Boot application
./mvnw spring-boot:run

# The service will be available at http://localhost:8080
```

## API Documentation

Once the service is running, you can access:

- **Swagger UI**: http://localhost:8080/swagger-ui.html
- **OpenAPI JSON**: http://localhost:8080/v3/api-docs/
- **OpenAPI YAML**: http://localhost:8080/v3/api-docs.yaml

The API documentation is generated by [springdoc-openapi](https://springdoc.org) based on the generated controllers and custom implementations.

## Regenerating from OpenAPI Spec

If the `openapi.yaml` specification is modified, regenerate the Spring Boot code:

```bash
cd ..  # Go to project root
openapi-generator-cli generate \
  -i openapi.yaml \
  -g spring-boot \
  -o numguess-service \
  -c openapitools.json
```

**Important**: Regeneration will overwrite files in `src/main/java/org/openapitools/` but NOT in `edu.luc.cs.numguess/`, preserving all custom business logic.

## Game Flow

1. **Create Game**: `POST /games` → Returns new game UUID with links
2. **Submit Guess**: `POST /games/{uuid}?guess=50` → Returns result (TOO_LOW, TOO_HIGH, CORRECT) with conditional links
3. **Get Game State**: `GET /games/{uuid}` → Returns current game state with submit-guess link only if active
4. **Delete Game**: `DELETE /games/{uuid}` → Removes game from storage
5. **List Games**: `GET /games` → Returns games collection with metadata

## Configuration

Spring Boot application properties can be configured in `src/main/resources/application.properties`:

```properties
server.port=8080
spring.application.name=numguess-service
```

## Testing

You can test the API using curl, Postman, or the built-in Swagger UI. Example:

```bash
# Create a new game
curl -X POST http://localhost:8080/games

# Submit a guess (replace {uuid} with actual game ID)
curl -X POST 'http://localhost:8080/games/{uuid}?guess=50'

# Get game state
curl http://localhost:8080/games/{uuid}

# Delete game
curl -X DELETE http://localhost:8080/games/{uuid}
```